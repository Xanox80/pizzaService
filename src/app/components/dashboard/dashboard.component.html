<div class="dashboard-container">
  <button
    class="burger-btn"
    [ngClass]="{ 'burger-btn--up': menuVisible }"
    (click)="toggleMenu()"
  >
    <span></span>
    <span></span>
    <span></span>
  </button>

  <div class="dashboard-menu" [ngClass]="{ open: menuVisible }">
    <p-panelMenu
      [model]="items"
      [style]="{ width: '260px' }"
      [multiple]="true"
    ></p-panelMenu>
  </div>

  <div class="dashboard-content">
    <h2>Dashboard</h2>

    <div class="goal-progress-card">
      <h3>–î–æ —Ü—ñ–ª—ñ {{ goalOrders }} –∑–∞–º–æ–≤–ª–µ–Ω—å –∑–∞–ª–∏—à–∏–ª–æ—Å—å:</h3>
      <div class="progress-bar-outer">
        <div class="progress-bar-inner" [style.width.%]="ordersProgress"></div>
      </div>
      <div class="progress-info">
        {{ ordersMonth }} / {{ goalOrders }} –∑–∞–º–æ–≤–ª–µ–Ω—å @if (ordersLeft > 0) {
        <span> (—â–µ {{ ordersLeft }}!)</span>
        } @else if (ordersLeft === 0) {
        <span> üéâ –ú–µ—Ç–∞ –¥–æ—Å—è–≥–Ω—É—Ç–∞!</span>
        }
      </div>
    </div>

    @switch (selectedSection) { @case ('orders') {
    <div class="stat-card">
      <i class="pi pi-calendar stat-icon"></i>
      <div>
        <h3>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
        <ul>
          <li>
            –°—å–æ–≥–æ–¥–Ω—ñ: <b>{{ ordersToday }}</b>
          </li>
          <li>
            –ó–∞ —Ç–∏–∂–¥–µ–Ω—å: <b>{{ ordersWeek }}</b>
          </li>
          <li>
            –ó–∞ –º—ñ—Å—è—Ü—å: <b>{{ ordersMonth }}</b>
          </li>
        </ul>
      </div>
    </div>
    } @case ('ingredients') {
    <div class="warehouse-section">
      <h3>–°–∫–ª–∞–¥ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤</h3>
      <div class="warehouse-list">
        @for (product of products; track product) {
        <div class="warehouse-item">
          <img
            [src]="product.image"
            [alt]="product.name"
            class="warehouse-img"
          />
          <div class="warehouse-info">
            <h4>{{ product.name }}</h4>
            <p>{{ product.description }}</p>
            <div class="warehouse-meta">
              <span class="warehouse-price">{{ product.price }} –≥—Ä–Ω</span>
              <span class="warehouse-category">{{ product.category }}</span>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
    } @case ('popular') {
    <h3>–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∞ –ø—ñ—Ü–∞</h3>
    @if (mostPopularPizza) {
    <div class="popular-pizza-card">
      <b>{{ mostPopularPizza.name }}</b> ‚Äî
      {{ mostPopularPizza.orders }} –∑–∞–º–æ–≤–ª–µ–Ω—å
    </div>
    } @else {
    <p>–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø—ñ—Ü–∏.</p>
    } } @case ('average') {
    <div class="stat-card">
      <i class="pi pi-wallet stat-icon"></i>
      <div>
        <h3>–°–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫</h3>
        <p class="average-check">
          <b>{{ averageCheck }} ‚Ç¥</b>
        </p>
      </div>
    </div>
    } @case ('logFeedbacks') {
    <h3>–õ–æ–≥–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—ñ–¥–≥—É–∫—ñ–≤</h3>
    @for (log of getFeedbackLogs(); track $index) {
    <div class="log-item">
      <p class="log-text">"{{ log.text }}"</p>
      <p class="log-date">–ó–∞–ª–∏—à–µ–Ω–æ: {{ log.date }}</p>
      <p class="log-removed">–í–∏–¥–∞–ª–µ–Ω–æ: {{ log.removedAt }}</p>
      <p class="log-user">–í–∏–¥–∞–ª–∏–≤: {{ log.removedBy }}</p>
      <button class="closeLogs" (click)="deleteLog($index)">–í–∏–¥–∞–ª–∏—Ç–∏</button>
    </div>
    } } @case ('LogPizza') {
    <h3>–õ–æ–≥–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—ñ—Ü</h3>
    @for (log of getPizzaLogs(); track $index) {
    <div class="log-item">
      <p class="log-text">{{ log.user }} {{ log.action }}</p>
      <p class="log-user">–ù–∞–∑–≤–∞ –ø—ñ—Ü—Ü–∏: ({{ log.name }})</p>
      <p class="log-date">–ß–∞—Å: {{ log.time }}</p>
      <button class="closeLogs" (click)="deletePizzaLog($index)">
        –í–∏–¥–∞–ª–∏—Ç–∏
      </button>
    </div>
    } } @case ('admins') { @if (SelectedAdmins) {
    <div class="admins">
      <i class="pi pi-users workers-icon"></i>
      <div>
        <h3>{{ SelectedAdmins.name }}</h3>
        <p>
          –°–∫—ñ–ª—å–∫–∏ —Ä–æ–∫—ñ–≤: <b>{{ SelectedAdmins.age }}</b>
        </p>
        <p>
          –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É: <b>{{ SelectedAdmins.phone }}</b>
        </p>
      </div>
    </div>
    } } @case ('bestCustomer') {
    <div class="stat-card">
      <i class="pi pi-user stat-icon"></i>
      <div>
        <h3>–ù–∞–π–∫—Ä–∞—â–∏–π –ø–æ–∫—É–ø–µ—Ü—å</h3>
        <p class="best-customer">
          <b>{{ bestCustomer }}</b>
        </p>
      </div>
    </div>
    } @case ('bestEmployee') {
    <div class="stat-card">
      <i class="pi pi-users stat-icon"></i>
      <div>
        <h3>–ù–∞–π–∫—Ä–∞—â–∏–π –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫</h3>
        <p class="best-employee">
          <b>{{ bestEmployee }}</b>
        </p>
      </div>
    </div>
    } @case ('logProductRemove') {
    <h3>–õ–æ–≥–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
    @if (getOrderRemoveLogs().length === 0) {
    <p>–õ–æ–≥—ñ–≤ –Ω–µ–º–∞—î.</p>
    } @for (log of getOrderRemoveLogs(); track $index) {
    <div class="log-item">
      <p class="log-text">
        "{{ log.name }}" (x{{ log.quantity }}) ‚Äì {{ log.price }} –≥—Ä–Ω
      </p>
      <p class="log-date">–î–∞—Ç–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è: –Ω–µ–≤—ñ–¥–æ–º–æ</p>
      <p class="log-removed">–í–∏–¥–∞–ª–µ–Ω–æ: {{ log.removedAt | date : "medium" }}</p>
      <p class="log-user">–í–∏–¥–∞–ª–∏–≤: {{ log.removedBy }}</p>
      <button class="closeLogs" (click)="deleteOrderLog($index)">
        –í–∏–¥–∞–ª–∏—Ç–∏
      </button>
    </div>
    } } @case ('feedback') {
    <div class="feedbacks-section">
      <h3>–í—ñ–¥–≥—É–∫–∏ —Ç–∞ –ø–æ—Ä–∞–¥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</h3>
      @if (feedbacks.length === 0) {
      <div class="text-feedback">–í—ñ–¥–≥—É–∫—ñ–≤ —â–µ –Ω–µ–º–∞—î.</div>
      }
      <ul>
        @for (fb of feedbacks; track $index) {
        <li>
          <span>{{ fb.text }}</span>
          <span class="feedback-date">{{ fb.date | date : "short" }}</span>
          <button class="btn-feedback" (click)="removeFeedback($index)">
            –í–∏–¥–∞–ª–∏—Ç–∏
          </button>
        </li>
        }
      </ul>
    </div>
    } @case ('workers') { @if (selectedWorker) {
    <div class="stat-card">
      <i class="pi pi-users workers-icon"></i>
      <div>
        <h3>{{ selectedWorker.name }}</h3>
        <p>
          –ü–æ—Å–∞–¥–∞: <b>{{ selectedWorker.position }}</b>
        </p>
        <p>
          –†–µ–π—Ç–∏–Ω–≥:
          <span class="rating">
            @if (selectedWorker.rating !== undefined) { @for (star of
            getStars(selectedWorker.rating); track star) {
            <i
              class="pi pi-star star"
              [ngClass]="{ filled: star === 'filled' }"
            ></i>
            } } @else {
            <span>–†–µ–π—Ç–∏–Ω–≥ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π</span>
            }
          </span>
        </p>
      </div>
    </div>
    } } @case ('megaDiscount') {
    <div class="stat-card">
      <i class="pi pi-tag stat-icon"></i>
      <div>
        <h3>–ê–∫—Ü—ñ—è –Ω–∞ –ø—ñ—Ü–∏</h3>
        <p class="mega-discount">
          <b>{{ megaDiscount }}</b>
        </p>
      </div>
    </div>
    } @case ('pizzaOrders') {
    <div class="cart-container">
      @if (cartItems.length === 0) {
      <div class="empty-cart">–ù–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç –∑–∞–∫–∞–∑–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ</div>
      } @if (cartItems.length > 0) {
      <div class="cart-items">
        @for (item of cartItems; track item.id) {
        <div class="cart-item">
          <img [src]="item.image" [alt]="item.name" class="item-image" />
          <div class="item-details">
            <h3>{{ item.name }}</h3>
            <p class="price">{{ item.price }} –≥—Ä–Ω</p>
          </div>
          <div class="quantity-controls">
            <span>{{ item.quantity }}</span>
          </div>
          <button class="remove-btn" (click)="remove(item.id)">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        </div>
        }
      </div>
      }
    </div>
    } @case ('megaDiscountEnd') {
    <div class="stat-card">
      <i class="pi pi-clock stat-icon"></i>
      <div>
        <h3>–ê–∫—Ü—ñ—è –Ω–∞ —Ç—Ä–µ—Ç—é –ø—ñ—Ü—É</h3>
        <p class="mega-discount-end">
          {{ megaDiscountEnd }}
        </p>
      </div>
    </div>
    } @case ('LogProductRemove') {
    <h3>–õ–æ–≥–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
    @for (log of getOrderRemoveLogs(); track log.id) {
    <div class="log-item">
      <p class="log-text">ID: {{ log.id }} | {{ log.name }}</p>
      <p class="log-date">
        –¶—ñ–Ω–∞: {{ log.price }} –≥—Ä–Ω, –ö—ñ–ª—å–∫—ñ—Å—Ç—å: {{ log.quantity }}
      </p>
      <p class="log-removed">–í–∏–¥–∞–ª–µ–Ω–æ: {{ log.removedAt }}</p>
      <p class="log-user">–í–∏–¥–∞–ª–∏–≤: {{ log.removedBy }}</p>
    </div>
    } } @default {} }
  </div>
</div>
